{"version":3,"file":"hds-array-field.cjs.development.js","sources":["../src/components/validation.ts","../src/components/ArrayField.tsx"],"sourcesContent":["import { array, object, SchemaOf, string, InferType } from 'yup';\r\n\r\nexport interface ArrayInputFieldProps {\r\n  value: string;\r\n}\r\n\r\nexport const ArrayFieldSchema: SchemaOf<ArrayInputFieldProps> = object()\r\n  .shape({\r\n    input: array(\r\n      object().shape({\r\n        value: string().required('input is required'),\r\n      })\r\n    ),\r\n  })\r\n  .required();\r\n\r\nexport type ArrayFieldTypeValues = InferType<typeof ArrayFieldSchema>;\r\n","import { AddIcon, DeleteIcon } from '@chakra-ui/icons';\r\nimport { Button, Flex, Icon, Text, VStack } from '@chakra-ui/react';\r\nimport { InputField } from '@highoutput/hds-forms';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport React, { ReactNode } from 'react';\r\nimport { useFieldArray, useForm } from 'react-hook-form';\r\nimport { ArrayFieldSchema, ArrayFieldTypeValues } from './validation';\r\n\r\nexport interface ArrayFieldProps {\r\n  buttonRemoveChildren?: ReactNode;\r\n  buttonAddChildren?: ReactNode;\r\n  defaultValues: {\r\n    input: ArrayFieldTypeValues[];\r\n  };\r\n  onChange: (data: Record<string, any>) => void;\r\n  onRemove: (data: Record<string, any>) => void;\r\n  onAppend: (data: Record<string, any>) => void;\r\n  onBlur: (data: Record<string, any>) => void;\r\n  maxValue?: number;\r\n  label?: string;\r\n  placeholder?: string;\r\n  isRequired?: boolean;\r\n}\r\n\r\nconst ArrayField = (props: ArrayFieldProps) => {\r\n  const {\r\n    placeholder,\r\n    defaultValues,\r\n\r\n    onChange,\r\n    onRemove,\r\n    onBlur,\r\n    onAppend,\r\n    label,\r\n    isRequired,\r\n    buttonAddChildren,\r\n    buttonRemoveChildren,\r\n    maxValue,\r\n  } = props;\r\n  const { control, register, handleSubmit, formState } = useForm<{\r\n    input: ArrayFieldTypeValues[];\r\n  }>({\r\n    defaultValues,\r\n    resolver: isRequired ? yupResolver(ArrayFieldSchema) : undefined,\r\n  });\r\n\r\n  const { fields, append, remove } = useFieldArray({\r\n    control,\r\n    name: 'input',\r\n  });\r\n\r\n  const handleAddField = handleSubmit(async (data) => {\r\n    if (maxValue && fields.length <= maxValue - 1) {\r\n      append({\r\n        value: '',\r\n      });\r\n      onAppend(data);\r\n    }\r\n  });\r\n\r\n  const handleOnBlurInput = handleSubmit(async (data) => {\r\n    onBlur(data);\r\n  });\r\n\r\n  const handleRemove = handleSubmit(async (data) => {\r\n    onRemove(data);\r\n  });\r\n\r\n  const handleOnChangeInput = handleSubmit(async (data) => {\r\n    onChange(data);\r\n  });\r\n\r\n  return (\r\n    <Flex flexDir=\"column\" gap={2}>\r\n      {label && <Text>{label}</Text>}\r\n      {fields.map((item, idx) => (\r\n        <Flex\r\n          gap={2}\r\n          key={item.id}\r\n          onBlur={handleOnBlurInput}\r\n          onChange={handleOnChangeInput}\r\n        >\r\n          <InputField\r\n            id={'input'}\r\n            placeholder={placeholder ?? ''}\r\n            {...register(`input.${idx}.value`)}\r\n            errorMsg={\r\n              isRequired ? formState.errors?.input?.[idx]?.value?.message : ''\r\n            }\r\n          />\r\n          <VStack>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                remove(idx);\r\n                handleRemove();\r\n              }}\r\n              disabled={fields.length <= 1}\r\n              width=\"32px\"\r\n              height=\"40px\"\r\n            >\r\n              {buttonRemoveChildren ? (\r\n                buttonRemoveChildren\r\n              ) : (\r\n                <Icon as={DeleteIcon} />\r\n              )}\r\n            </Button>\r\n            {idx === fields.length - 1 && (\r\n              <Button\r\n                variant=\"outline\"\r\n                width=\"32px\"\r\n                height=\"40px\"\r\n                disabled={maxValue === fields.length}\r\n                onClick={handleAddField}\r\n              >\r\n                {buttonAddChildren ? buttonAddChildren : <Icon as={AddIcon} />}\r\n              </Button>\r\n            )}\r\n          </VStack>\r\n        </Flex>\r\n      ))}\r\n    </Flex>\r\n  );\r\n};\r\n\r\nexport default ArrayField;\r\n"],"names":["ArrayFieldSchema","object","shape","input","array","value","string","required","ArrayField","props","placeholder","defaultValues","onChange","onRemove","onBlur","onAppend","label","isRequired","buttonAddChildren","buttonRemoveChildren","maxValue","useForm","resolver","yupResolver","undefined","control","register","handleSubmit","formState","useFieldArray","name","fields","append","remove","handleAddField","data","length","handleOnBlurInput","handleRemove","handleOnChangeInput","React","Flex","flexDir","gap","Text","map","item","idx","key","id","InputField","errorMsg","errors","message","VStack","Button","variant","onClick","disabled","width","height","Icon","as","DeleteIcon","AddIcon"],"mappings":"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"}