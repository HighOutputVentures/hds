{"version":3,"file":"hds-array-field.cjs.production.min.js","sources":["../src/components/validation.ts","../src/components/ArrayField.tsx"],"sourcesContent":["import { array, object, SchemaOf, string, InferType } from 'yup';\r\n\r\nexport interface ArrayInputFieldProps {\r\n  value: string;\r\n}\r\n\r\nexport const ArrayFieldSchema: SchemaOf<ArrayInputFieldProps> = object()\r\n  .shape({\r\n    input: array(\r\n      object().shape({\r\n        value: string().required('input is required'),\r\n      })\r\n    ),\r\n  })\r\n  .required();\r\n\r\nexport type ArrayFieldTypeValues = InferType<typeof ArrayFieldSchema>;\r\n","import { AddIcon, DeleteIcon } from '@chakra-ui/icons';\r\nimport { Button, Flex, Icon, Text, VStack } from '@chakra-ui/react';\r\nimport { InputField } from '@highoutput/hds-forms';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport React, { ReactNode } from 'react';\r\nimport { useFieldArray, useForm } from 'react-hook-form';\r\nimport { ArrayFieldSchema, ArrayFieldTypeValues } from './validation';\r\n\r\nexport interface ArrayFieldProps {\r\n  buttonRemoveChildren?: ReactNode;\r\n  buttonAddChildren?: ReactNode;\r\n  defaultValues: {\r\n    input: ArrayFieldTypeValues[];\r\n  };\r\n  onChange: (data: Record<string, any>) => void;\r\n  onRemove: (data: Record<string, any>) => void;\r\n  onAppend: (data: Record<string, any>) => void;\r\n  onBlur: (data: Record<string, any>) => void;\r\n  maxValue?: number;\r\n  label?: string;\r\n  placeholder?: string;\r\n  isRequired?: boolean;\r\n}\r\n\r\nconst ArrayField = (props: ArrayFieldProps) => {\r\n  const {\r\n    placeholder,\r\n    defaultValues,\r\n\r\n    onChange,\r\n    onRemove,\r\n    onBlur,\r\n    onAppend,\r\n    label,\r\n    isRequired,\r\n    buttonAddChildren,\r\n    buttonRemoveChildren,\r\n    maxValue,\r\n  } = props;\r\n  const { control, register, handleSubmit, formState } = useForm<{\r\n    input: ArrayFieldTypeValues[];\r\n  }>({\r\n    defaultValues,\r\n    resolver: isRequired ? yupResolver(ArrayFieldSchema) : undefined,\r\n  });\r\n\r\n  const { fields, append, remove } = useFieldArray({\r\n    control,\r\n    name: 'input',\r\n  });\r\n\r\n  const handleAddField = handleSubmit(async (data) => {\r\n    if (maxValue && fields.length <= maxValue - 1) {\r\n      append({\r\n        value: '',\r\n      });\r\n      onAppend(data);\r\n    }\r\n  });\r\n\r\n  const handleOnBlurInput = handleSubmit(async (data) => {\r\n    onBlur(data);\r\n  });\r\n\r\n  const handleRemove = handleSubmit(async (data) => {\r\n    onRemove(data);\r\n  });\r\n\r\n  const handleOnChangeInput = handleSubmit(async (data) => {\r\n    onChange(data);\r\n  });\r\n\r\n  return (\r\n    <Flex flexDir=\"column\" gap={2}>\r\n      {label && <Text>{label}</Text>}\r\n      {fields.map((item, idx) => (\r\n        <Flex\r\n          gap={2}\r\n          key={item.id}\r\n          onBlur={handleOnBlurInput}\r\n          onChange={handleOnChangeInput}\r\n        >\r\n          <InputField\r\n            id={'input'}\r\n            placeholder={placeholder ?? ''}\r\n            {...register(`input.${idx}.value`)}\r\n            errorMsg={\r\n              isRequired ? formState.errors?.input?.[idx]?.value?.message : ''\r\n            }\r\n          />\r\n          <VStack>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                remove(idx);\r\n                handleRemove();\r\n              }}\r\n              disabled={fields.length <= 1}\r\n              width=\"32px\"\r\n              height=\"40px\"\r\n            >\r\n              {buttonRemoveChildren ? (\r\n                buttonRemoveChildren\r\n              ) : (\r\n                <Icon as={DeleteIcon} />\r\n              )}\r\n            </Button>\r\n            {idx === fields.length - 1 && (\r\n              <Button\r\n                variant=\"outline\"\r\n                width=\"32px\"\r\n                height=\"40px\"\r\n                disabled={maxValue === fields.length}\r\n                onClick={handleAddField}\r\n              >\r\n                {buttonAddChildren ? buttonAddChildren : <Icon as={AddIcon} />}\r\n              </Button>\r\n            )}\r\n          </VStack>\r\n        </Flex>\r\n      ))}\r\n    </Flex>\r\n  );\r\n};\r\n\r\nexport default ArrayField;\r\n"],"names":["ArrayFieldSchema","object","shape","input","array","value","string","required","props","placeholder","onChange","onRemove","onBlur","onAppend","label","isRequired","buttonAddChildren","buttonRemoveChildren","maxValue","useForm","defaultValues","resolver","yupResolver","undefined","register","handleSubmit","formState","useFieldArray","control","name","fields","append","remove","handleAddField","data","length","handleOnBlurInput","handleRemove","handleOnChangeInput","React","Flex","flexDir","gap","Text","map","item","idx","key","id","InputField","errorMsg","errors","_formState$errors","_formState$errors$inp","_formState$errors$inp2","_formState$errors$inp3","message","VStack","Button","variant","onClick","disabled","width","height","Icon","as","DeleteIcon","AddIcon"],"mappings":"u7NAMO,IAAMA,EAAmDC,WAC7DC,MAAM,CACLC,MAAOC,QACLH,WAASC,MAAM,CACbG,MAAOC,WAASC,SAAS,0BAI9BA,8BCUgB,SAACC,GAClB,IACEC,EAYED,EAZFC,YAGAC,EASEF,EATFE,SACAC,EAQEH,EARFG,SACAC,EAOEJ,EAPFI,OACAC,EAMEL,EANFK,SACAC,EAKEN,EALFM,MACAC,EAIEP,EAJFO,WACAC,EAGER,EAHFQ,kBACAC,EAEET,EAFFS,qBACAC,EACEV,EADFU,WAEqDC,UAEpD,CACDC,cAJEZ,EAXFY,cAgBAC,SAAUN,EAAaO,cAAYtB,QAAoBuB,IAJxCC,IAAAA,SAAUC,IAAAA,aAAcC,IAAAA,YAONC,gBAAc,CAC/CC,UARMA,QASNC,KAAM,UAFAC,IAAAA,OAAQC,IAAAA,OAAQC,IAAAA,OAKlBC,EAAiBR,aAAY,kBAAC,WAAOS,GAAI,6BAAA,OAAA,sBAAA,OACzChB,GAAYY,EAAOK,QAAUjB,EAAW,IAC1Ca,EAAO,CACL1B,MAAO,KAETQ,EAASqB,IACV,OAAA,UAAA,0BACF,mBAAA,oCAEKE,EAAoBX,aAAY,kBAAC,WAAOS,GAAI,6BAAA,OAAA,sBAAA,OAChDtB,EAAOsB,GAAM,OAAA,UAAA,0BACd,mBAAA,oCAEKG,EAAeZ,aAAY,kBAAC,WAAOS,GAAI,6BAAA,OAAA,sBAAA,OAC3CvB,EAASuB,GAAM,OAAA,UAAA,0BAChB,mBAAA,oCAEKI,EAAsBb,aAAY,kBAAC,WAAOS,GAAI,6BAAA,OAAA,sBAAA,OAClDxB,EAASwB,GAAM,OAAA,UAAA,0BAChB,mBAAA,oCAED,OACEK,gBAACC,QAAKC,QAAQ,SAASC,IAAK,GACzB5B,GAASyB,gBAACI,YAAM7B,GAChBgB,EAAOc,KAAI,SAACC,EAAMC,GAAG,YAAA,OACpBP,gBAACC,QACCE,IAAK,EACLK,IAAKF,EAAKG,GACVpC,OAAQwB,EACR1B,SAAU4B,GAEVC,gBAACU,4BACCD,GAAI,QACJvC,kBAAaA,EAAAA,EAAe,IACxBe,WAAkBsB,aACtBI,SACEnC,WAAaW,EAAUyB,kBAAVC,EAAkBjD,iBAAlBkD,EAA0BP,cAA1BQ,EAAgCjD,cAAhCkD,EAAuCC,QAAU,MAGlEjB,gBAACkB,cACClB,gBAACmB,UACCC,QAAQ,UACRC,QAAS,WACP5B,EAAOc,GACPT,KAEFwB,SAAU/B,EAAOK,QAAU,EAC3B2B,MAAM,OACNC,OAAO,QAEN9C,GAGCsB,gBAACyB,QAAKC,GAAIC,gBAGbpB,IAAQhB,EAAOK,OAAS,GACvBI,gBAACmB,UACCC,QAAQ,UACRG,MAAM,OACNC,OAAO,OACPF,SAAU3C,IAAaY,EAAOK,OAC9ByB,QAAS3B,GAERjB,GAAwCuB,gBAACyB,QAAKC,GAAIE"}