{"version":3,"file":"hds-auth.esm.js","sources":["../src/components/AuthProvider/AuthContext.tsx","../src/components/AuthProvider/AuthProvider.tsx","../src/components/AuthProvider/constants.ts","../src/components/AuthProvider/getAuthState.ts","../src/components/AuthProvider/logout.ts","../src/components/AuthProvider/utils.ts","../src/components/AuthProvider/useAuthService.tsx","../src/components/AuthProvider/useAuthState.tsx","../src/components/AuthProvider/useProfile.tsx","../src/components/AuthForm/validation.ts","../src/components/AuthForm/CredentialLoginForm.tsx","../src/components/AuthForm/OTPForm.tsx","../src/components/AuthForm/OTPVerificationForm.tsx"],"sourcesContent":["import * as React from 'react';\nimport type { AuthConfig } from './types';\n\nconst AuthContext = React.createContext<AuthConfig>({\n  hostname: '',\n});\n\nexport default AuthContext;\n","import * as React from 'react';\nimport AuthContext from './AuthContext';\nimport type { AuthConfig } from './types';\n\nexport default function AuthProvider({children, ...config}: React.PropsWithChildren<AuthConfig>) {\n  return <AuthContext.Provider value={config}>{children}</AuthContext.Provider>;\n}","const accessTokenId = '__AuthToken__';\n\nconst constants = {\n  accessTokenId,\n};\n\nexport default constants;\n","import cookies from 'js-cookie';\nimport constants from './constants';\nimport type { AuthState } from './types';\n\nexport default function getAuthState(): AuthState {\n  const token = cookies.get(constants.accessTokenId);\n\n  return {\n    token,\n    status: token ? 'authenticated' : 'unauthenticated',\n  };\n}","import cookies from 'js-cookie';\nimport constants from './constants';\n\nexport default function logout(callback?: () => void) {\n  cookies.remove(constants.accessTokenId);\n  callback?.();\n}\n","export async function postJson<T>(\n  url: string,\n  postfields: Record<string, unknown>\n): Promise<T> {\n  const response = await fetch(url, {\n    body: JSON.stringify(postfields),\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n  });\n\n  const parsed = await response.json();\n  if (!response.ok) throw new Error(parsed.error.message);\n  return parsed;\n}\n","import cookies from 'js-cookie';\nimport * as React from 'react';\nimport AuthContext from './AuthContext';\nimport constants from './constants';\nimport type { AuthService } from './types';\nimport { postJson } from './utils';\n\nexport default function useAuthService() {\n  const {hostname} = React.useContext(AuthContext);\n\n  const generateOtp: AuthService['generateOtp'] = React.useCallback(\n    async (emailAddress) => {\n      await postJson(`${hostname}/otp/generate`, {emailAddress});\n    },\n    [hostname],\n  );\n\n  const validateOtp: AuthService['validateOtp'] = React.useCallback(\n    async (otp) => {\n      const {token} = await postJson<{token: string}>(`${hostname}/otp/validate`, {otp});\n\n      cookies.set(constants.accessTokenId, token, {\n        secure: process.env.NODE_ENV === 'production',\n        expires: 29,\n        sameSite: 'strict',\n      });\n    },\n    [hostname],\n  );\n\n  return {\n    generateOtp,\n    validateOtp,\n  };\n}","import * as React from 'react';\nimport getAuthState from './getAuthState';\nimport type { AuthState } from './types';\n\ntype Config = {\n  onauthenticated: () => void;\n  onunauthenticated: () => void;\n};\n\nexport default function useAuthState({onauthenticated, onunauthenticated}: Partial<Config> = {}) {\n  const [state, setState] = React.useState<AuthState>({\n    status: 'loading',\n  });\n\n  const handleState = React.useCallback(() => {\n    const newState = getAuthState();\n    setState(newState);\n  }, []);\n\n  React.useEffect(() => {\n    handleState();\n    return () => setState({status: 'loading'});\n  }, [handleState]);\n\n  React.useEffect(() => {\n    document.addEventListener('visibilitychange', handleState);\n    return () => document.removeEventListener('visibilitychange', handleState);\n  }, [handleState]);\n\n  React.useEffect(() => {\n    if (state.status === 'authenticated') onauthenticated?.();\n    if (state.status === 'unauthenticated') onunauthenticated?.();\n  }, [onauthenticated, onunauthenticated, state.status]);\n\n  return state;\n}\n","/**\n *\n * _NOT IMPLEMENTED YET_\n *\n */\nexport default function useProfile() {\n  return {};\n}\n","import { InferType, object, SchemaOf, string } from 'yup';\n\nexport interface CredentialFormInputEmailProps {\n  email: string;\n  password: string;\n}\n\nexport const withCredentialFormSchemaEmail: SchemaOf<CredentialFormInputEmailProps> = object().shape(\n  {\n    email: string()\n      .email('Please enter a valid email address')\n      .required('Email is required.'),\n    password: string().required('Password is required'),\n  }\n);\n\nexport type withCredentialFormSchemaEmailValues = InferType<\n  typeof withCredentialFormSchemaEmail\n>;\nexport interface CredentialFormInputNameProps {\n  name: string;\n  password: string;\n}\n\nexport const withCredentialFormSchemaName: SchemaOf<CredentialFormInputNameProps> = object().shape(\n  {\n    name: string()\n      .required('Name is required')\n      .trim(),\n    password: string().required('Password is required'),\n  }\n);\n\nexport type withCredentialFormSchemaNameValues = InferType<\n  typeof withCredentialFormSchemaName\n>;\n\nexport const generateEmailOTPSchema: SchemaOf<{\n  emailAddress: string;\n}> = object().shape({\n  emailAddress: string()\n    .email('Please enter a valid email address.')\n    .required('Email is required.'),\n});\n\nexport type GenerateEmailOTPSchemaValues = InferType<\n  typeof generateEmailOTPSchema\n>;\n\nexport const authenticateSchema: SchemaOf<{\n  otp: string;\n}> = object().shape({\n  otp: string()\n    .when(\n      '$numberOfFields',\n      (numberOfFields: number, authenticateSchema: any) => {\n        return authenticateSchema.length(\n          numberOfFields,\n          'OTP code is incomplete.'\n        );\n      }\n    )\n    .required('OTP code is required.'),\n});\n\nexport type AuthenticateSchemaValues = InferType<typeof authenticateSchema>;\n","import { ViewIcon, ViewOffIcon } from '@chakra-ui/icons';\nimport { Box, Button, Center, Stack, Text } from '@chakra-ui/react';\nimport { InputField } from '@highoutput/hds-forms';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport React, { FC, ReactNode } from 'react';\nimport { useForm } from 'react-hook-form';\n\nimport {\n  CredentialFormInputEmailProps,\n  CredentialFormInputNameProps,\n  withCredentialFormSchemaEmail,\n  withCredentialFormSchemaEmailValues,\n  withCredentialFormSchemaName,\n  withCredentialFormSchemaNameValues,\n} from './validation';\n\nexport type CredentialLoginFormDefaultProps = {\n  loginTitle?: ReactNode;\n  signUpTitle?: ReactNode;\n};\nexport interface CredentialLoginFormNameProps\n  extends CredentialLoginFormDefaultProps {\n  variant?: 'name-password';\n  nameLabel: string;\n  onSubmit?(values: CredentialFormInputNameProps): void;\n}\nexport interface CredentialLoginFormEmailProps\n  extends CredentialLoginFormDefaultProps {\n  variant?: 'email-password';\n  nameLabel?: never;\n  onSubmit?(values: CredentialFormInputEmailProps): void;\n}\n\nexport type CredentialLoginFormProps =\n  | CredentialLoginFormNameProps\n  | CredentialLoginFormEmailProps;\n\nconst CredentialLoginForm: FC<CredentialLoginFormProps> = (props) => {\n  const {\n    signUpTitle,\n    loginTitle,\n    variant,\n    onSubmit,\n    nameLabel = 'Username',\n  } = props;\n\n  const [showPassword, setShowPassword] = React.useState(false);\n  const [isSignUp, setIsSignUp] = React.useState(false);\n  const { register, handleSubmit, formState } = useForm<\n    withCredentialFormSchemaEmailValues & withCredentialFormSchemaNameValues\n  >({\n    resolver: yupResolver(\n      variant === 'name-password'\n        ? withCredentialFormSchemaName\n        : withCredentialFormSchemaEmail\n    ),\n    shouldUnregister: true,\n  });\n\n  const onSubmitForm = async (\n    values: withCredentialFormSchemaNameValues &\n      withCredentialFormSchemaEmailValues\n  ) => {\n    if (onSubmit) {\n      onSubmit(values);\n    }\n  };\n\n  return (\n    <Box as={'form'} maxW={512} onSubmit={handleSubmit(onSubmitForm)}>\n      <Center m={0} p={0}>\n        {isSignUp && signUpTitle ? (\n          signUpTitle\n        ) : !isSignUp && loginTitle ? (\n          loginTitle\n        ) : !isSignUp && !loginTitle ? (\n          <Text size=\"header-3\" my={8}>\n            Login\n          </Text>\n        ) : (\n          isSignUp &&\n          !signUpTitle && (\n            <Text size=\"header-3\" my={8}>\n              Sign up\n            </Text>\n          )\n        )}\n      </Center>\n\n      <Stack spacing={'1rem'}>\n        {variant === 'name-password' ? (\n          <InputField\n            {...register('name')}\n            id={'name'}\n            label={nameLabel?.charAt(0).toUpperCase() + nameLabel?.slice(1)}\n            placeholder={`Input your ${nameLabel?.toLowerCase()}`}\n            errorMsg={formState.errors.name?.message}\n            disabled={formState.isSubmitting}\n            partProps={{\n              input: {\n                'aria-label': 'name-input',\n                role: 'input',\n              },\n            }}\n          />\n        ) : (\n          <InputField\n            {...register('email')}\n            id={'email'}\n            label=\"Email\"\n            placeholder=\"Input your email\"\n            errorMsg={formState.errors.email?.message}\n            disabled={formState.isSubmitting}\n            partProps={{\n              input: { 'aria-label': 'email-input', role: 'input' },\n            }}\n          />\n        )}\n\n        <InputField\n          {...register('password')}\n          id=\"password\"\n          label=\"Password\"\n          type={showPassword ? 'text' : 'password'}\n          placeholder=\"Input your password\"\n          errorMsg={formState.errors.password?.message}\n          disabled={formState.isSubmitting}\n          rightIcon={\n            <Button\n              data-testid={'show-hide-btn'}\n              background={'none'}\n              _hover={{ background: 'none' }}\n              _active={{ background: 'none' }}\n              aria-label={showPassword ? 'show-password' : 'hide-password'}\n              onClick={() => setShowPassword((prev) => !prev)}\n            >\n              {showPassword ? <ViewIcon /> : <ViewOffIcon />}\n            </Button>\n          }\n          partProps={{\n            input: {\n              'aria-label': 'password-input',\n              role: 'input',\n            },\n          }}\n        />\n      </Stack>\n      <Button\n        w=\"full\"\n        variant=\"primary\"\n        isLoading={formState.isSubmitting}\n        type=\"submit\"\n        my={8}\n      >\n        {isSignUp ? 'Sign Up' : 'Login'}\n      </Button>\n      <Center>\n        <Text>\n          {isSignUp ? 'Already have an account?' : 'No account yet?'}{' '}\n          <Text\n            as={'a'}\n            data-testid={'switch-form-link'}\n            _hover={{ textDecoration: 'underline', cursor: 'pointer' }}\n            aria-label={isSignUp ? 'login-link-label' : 'signup-link-label'}\n            onClick={() => setIsSignUp((prev) => !prev)}\n            fontWeight={'bold'}\n            role={'link'}\n          >\n            {isSignUp ? 'Login' : 'Sign up'}\n          </Text>\n        </Text>\n      </Center>\n    </Box>\n  );\n};\n\nexport default CredentialLoginForm;\n","import { Box, Button, Heading, Text } from '@chakra-ui/react';\nimport { PinInputField } from '@highoutput/hds-forms';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport React, { ReactNode } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { authenticateSchema, AuthenticateSchemaValues } from './validation';\n\nexport interface OTPFormProps {\n  title?: ReactNode;\n  subTitle?: ReactNode;\n  numberOfFields?: number;\n  buttonText?: string;\n  otpType?: 'number' | 'alphanumeric';\n  onSubmitOTPValue?(value: AuthenticateSchemaValues): void;\n}\nconst OTPForm = (props: OTPFormProps) => {\n  const {\n    subTitle,\n    title,\n    otpType = 'number',\n    numberOfFields = 6,\n    buttonText,\n    onSubmitOTPValue,\n  } = props;\n  const buttonRef = React.useRef<HTMLButtonElement>(null);\n  const {\n    register: registerOtp,\n    handleSubmit: handleSubmitOtp,\n    formState: formStateOtp,\n  } = useForm<AuthenticateSchemaValues>({\n    resolver: yupResolver(authenticateSchema),\n    context: { numberOfFields: numberOfFields },\n    shouldUnregister: true,\n    defaultValues: {\n      otp: '',\n    },\n  });\n  const onSubmitOTP = async (value: AuthenticateSchemaValues) => {\n    if (onSubmitOTPValue) {\n      onSubmitOTPValue(value);\n    }\n  };\n  return (\n    <Box\n      as=\"form\"\n      w={350}\n      data-testid=\"box.otpform.form\"\n      onSubmit={handleSubmitOtp(onSubmitOTP)}\n    >\n      <Box mb=\"6\">\n        {title ? (\n          title\n        ) : (\n          <Heading as=\"h1\" mb={2}>\n            Check your inbox\n          </Heading>\n        )}\n\n        {subTitle ? (\n          subTitle\n        ) : (\n          <Text>We have sent a 6-digit code to your email </Text>\n        )}\n      </Box>\n\n      <PinInputField\n        id=\"otp\"\n        {...registerOtp('otp')}\n        errorMsg={formStateOtp.errors.otp?.message}\n        disabled={formStateOtp.isSubmitting}\n        numberOfFields={numberOfFields}\n        autoFocus\n        onComplete={buttonRef.current?.click}\n        type={otpType}\n      />\n      <Button\n        variant={'primary'}\n        ref={buttonRef}\n        type=\"submit\"\n        isLoading={formStateOtp.isSubmitting}\n        width={'100%'}\n        data-testid=\"button.otp.submit\"\n        marginTop={5}\n      >\n        {buttonText ? buttonText : 'Sign In'}\n      </Button>\n    </Box>\n  );\n};\n\nexport default OTPForm;\n","import { Box, Button } from '@chakra-ui/react';\nimport { InputField } from '@highoutput/hds-forms';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport React from 'react';\nimport { useForm } from 'react-hook-form';\nimport OTPForm, { OTPFormProps } from './OTPForm';\nimport {\n  AuthenticateSchemaValues,\n  generateEmailOTPSchema,\n  GenerateEmailOTPSchemaValues,\n} from './validation';\n\nexport interface OTPVerificationProps extends OTPFormProps {\n  onSubmitEmailValue?(value: GenerateEmailOTPSchemaValues): void;\n  onSubmitOTPValue?(value: AuthenticateSchemaValues): void;\n  otpReceived: boolean;\n  numberOfFields?: number;\n  otpType?: 'number' | 'alphanumeric';\n}\n\nconst OTPVerificationForm = (props: OTPVerificationProps) => {\n  const {\n    otpReceived,\n    onSubmitEmailValue,\n    numberOfFields,\n    title,\n    subTitle,\n    onSubmitOTPValue,\n  } = props;\n\n  const { register, handleSubmit, formState } =\n    useForm<GenerateEmailOTPSchemaValues>({\n      resolver: yupResolver(generateEmailOTPSchema),\n      defaultValues: {\n        emailAddress: '',\n      },\n      shouldUnregister: true,\n    });\n\n  const onSubmitEmail = async (value: GenerateEmailOTPSchemaValues) => {\n    if (onSubmitEmailValue) {\n      onSubmitEmailValue(value);\n    }\n  };\n  const onSubmitOTP = async (value: AuthenticateSchemaValues) => {\n    if (onSubmitOTPValue) {\n      onSubmitOTPValue(value);\n    }\n  };\n\n  const { errors, isSubmitting } = formState;\n\n  return (\n    <Box>\n      {!otpReceived ? (\n        <Box\n          as={'form'}\n          data-testid=\"box.emailform.form\"\n          w={350}\n          onSubmit={handleSubmit(onSubmitEmail)}\n        >\n          <InputField\n            id=\"emailAddress\"\n            {...register('emailAddress')}\n            errorMsg={errors.emailAddress?.message}\n            disabled={isSubmitting}\n            placeholder={'Enter your email address'}\n            partProps={{\n              input: {\n                'aria-label': 'email-input',\n                role: 'input',\n              },\n            }}\n          />\n\n          <Button\n            variant={'primary'}\n            type=\"submit\"\n            isLoading={isSubmitting}\n            width={'100%'}\n            marginTop={'10px'}\n            data-testid=\"button.email.submit\"\n          >\n            Sign In\n          </Button>\n        </Box>\n      ) : (\n        <Box data-testid=\"otp.component\">\n          <OTPForm\n            title={title}\n            subTitle={subTitle}\n            onSubmitOTPValue={(value) => onSubmitOTP(value)}\n            numberOfFields={numberOfFields}\n          />\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nexport default OTPVerificationForm;\n"],"names":["AuthContext","React","hostname","AuthProvider","children","config","Provider","value","accessTokenId","constants","getAuthState","token","cookies","get","status","logout","callback","remove","postJson","url","postfields","fetch","body","JSON","stringify","method","headers","response","json","parsed","ok","Error","error","message","useAuthService","generateOtp","emailAddress","validateOtp","otp","set","secure","process","env","NODE_ENV","expires","sameSite","useAuthState","onauthenticated","onunauthenticated","state","setState","handleState","newState","document","addEventListener","removeEventListener","useProfile","withCredentialFormSchemaEmail","object","shape","email","string","required","password","withCredentialFormSchemaName","name","trim","generateEmailOTPSchema","authenticateSchema","when","numberOfFields","length","CredentialLoginForm","props","signUpTitle","loginTitle","variant","onSubmit","nameLabel","useState","showPassword","setShowPassword","isSignUp","setIsSignUp","useForm","resolver","yupResolver","shouldUnregister","register","handleSubmit","formState","onSubmitForm","values","Box","as","maxW","Center","m","p","Text","size","my","Stack","spacing","InputField","id","label","charAt","toUpperCase","slice","placeholder","toLowerCase","errorMsg","errors","disabled","isSubmitting","partProps","input","role","type","rightIcon","Button","background","_hover","_active","onClick","prev","ViewIcon","ViewOffIcon","w","isLoading","textDecoration","cursor","fontWeight","OTPForm","subTitle","title","otpType","buttonText","onSubmitOTPValue","buttonRef","useRef","context","defaultValues","registerOtp","handleSubmitOtp","formStateOtp","onSubmitOTP","mb","Heading","PinInputField","autoFocus","onComplete","current","click","ref","width","marginTop","OTPVerificationForm","otpReceived","onSubmitEmailValue","onSubmitEmail"],"mappings":";;;;;;;;;AAGA,IAAMA,WAAW,gBAAGC,aAAmB,CAAa;EAClDC,QAAQ,EAAE;CACX,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLF,SAIwBC,YAAY;MAAEC,QAAQ,QAARA,QAAQ;IAAKC,MAAM;EACvD,OAAOJ,cAACD,WAAW,CAACM,QAAQ;IAACC,KAAK,EAAEF;KAASD,QAAQ,CAAwB;AAC/E;;ACNA,IAAMI,aAAa,GAAG,eAAe;AAErC,IAAMC,SAAS,GAAG;EAChBD,aAAa,EAAbA;CACD;;SCAuBE,YAAY;EAClC,IAAMC,KAAK,GAAGC,OAAO,CAACC,GAAG,CAACJ,SAAS,CAACD,aAAa,CAAC;EAElD,OAAO;IACLG,KAAK,EAALA,KAAK;IACLG,MAAM,EAAEH,KAAK,GAAG,eAAe,GAAG;GACnC;AACH;;SCRwBI,MAAM,CAACC,QAAqB;EAClDJ,OAAO,CAACK,MAAM,CAACR,SAAS,CAACD,aAAa,CAAC;EACvCQ,QAAQ,oBAARA,QAAQ,EAAI;AACd;;SCNsBE,QAAQ;EAAA;AAAA;AAe7B;EAAA,uEAfM,iBACLC,GAAW,EACXC,UAAmC;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA,OAEZC,KAAK,CAACF,GAAG,EAAE;cAChCG,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,UAAU,CAAC;cAChCK,MAAM,EAAE,MAAM;cACdC,OAAO,EAAE;gBACP,cAAc,EAAE;;aAEnB,CAAC;UAAA;YANIC,QAAQ;YAAA;YAAA,OAQOA,QAAQ,CAACC,IAAI,EAAE;UAAA;YAA9BC,MAAM;YAAA,IACPF,QAAQ,CAACG,EAAE;cAAA;cAAA;;YAAA,MAAQ,IAAIC,KAAK,CAACF,MAAM,CAACG,KAAK,CAACC,OAAO,CAAC;UAAA;YAAA,iCAChDJ,MAAM;UAAA;UAAA;YAAA;;;;GACd;EAAA;AAAA;;SCRuBK,cAAc;EACpC,wBAAmBjC,UAAgB,CAACD,WAAW,CAAC;IAAzCE,QAAQ,qBAARA,QAAQ;EAEf,IAAMiC,WAAW,GAA+BlC,WAAiB;IAAA,sEAC/D,iBAAOmC,YAAY;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACXlB,QAAQ,CAAIhB,QAAQ,oBAAiB;gBAACkC,YAAY,EAAZA;eAAa,CAAC;YAAA;YAAA;cAAA;;;;KAC3D;IAAA;MAAA;;OACD,CAAClC,QAAQ,CAAC,CACX;EAED,IAAMmC,WAAW,GAA+BpC,WAAiB;IAAA,uEAC/D,kBAAOqC,GAAG;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACcpB,QAAQ,CAAqBhB,QAAQ,oBAAiB;gBAACoC,GAAG,EAAHA;eAAI,CAAC;YAAA;cAAA;cAA3E3B,KAAK,mBAALA,KAAK;cAEZC,OAAO,CAAC2B,GAAG,CAAC9B,SAAS,CAACD,aAAa,EAAEG,KAAK,EAAE;gBAC1C6B,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY;gBAC7CC,OAAO,EAAE,EAAE;gBACXC,QAAQ,EAAE;eACX,CAAC;YAAC;YAAA;cAAA;;;;KACJ;IAAA;MAAA;;OACD,CAAC3C,QAAQ,CAAC,CACX;EAED,OAAO;IACLiC,WAAW,EAAXA,WAAW;IACXE,WAAW,EAAXA;GACD;AACH;;SCzBwBS,YAAY;gCAAyD,EAAE;IAAzDC,eAAe,QAAfA,eAAe;IAAEC,iBAAiB,QAAjBA,iBAAiB;EACtE,sBAA0B/C,QAAc,CAAY;MAClDa,MAAM,EAAE;KACT,CAAC;IAFKmC,KAAK;IAAEC,QAAQ;EAItB,IAAMC,WAAW,GAAGlD,WAAiB,CAAC;IACpC,IAAMmD,QAAQ,GAAG1C,YAAY,EAAE;IAC/BwC,QAAQ,CAACE,QAAQ,CAAC;GACnB,EAAE,EAAE,CAAC;EAENnD,SAAe,CAAC;IACdkD,WAAW,EAAE;IACb,OAAO;MAAA,OAAMD,QAAQ,CAAC;QAACpC,MAAM,EAAE;OAAU,CAAC;;GAC3C,EAAE,CAACqC,WAAW,CAAC,CAAC;EAEjBlD,SAAe,CAAC;IACdoD,QAAQ,CAACC,gBAAgB,CAAC,kBAAkB,EAAEH,WAAW,CAAC;IAC1D,OAAO;MAAA,OAAME,QAAQ,CAACE,mBAAmB,CAAC,kBAAkB,EAAEJ,WAAW,CAAC;;GAC3E,EAAE,CAACA,WAAW,CAAC,CAAC;EAEjBlD,SAAe,CAAC;IACd,IAAIgD,KAAK,CAACnC,MAAM,KAAK,eAAe,EAAEiC,eAAe,oBAAfA,eAAe,EAAI;IACzD,IAAIE,KAAK,CAACnC,MAAM,KAAK,iBAAiB,EAAEkC,iBAAiB,oBAAjBA,iBAAiB,EAAI;GAC9D,EAAE,CAACD,eAAe,EAAEC,iBAAiB,EAAEC,KAAK,CAACnC,MAAM,CAAC,CAAC;EAEtD,OAAOmC,KAAK;AACd;;ACnCA;;;;;AAKA,SAAwBO,UAAU;EAChC,OAAO,EAAE;AACX;;ACAO,IAAMC,6BAA6B,gBAA4CC,MAAM,EAAE,CAACC,KAAK,CAClG;EACEC,KAAK,eAAEC,MAAM,EAAE,CACZD,KAAK,CAAC,oCAAoC,CAAC,CAC3CE,QAAQ,CAAC,oBAAoB,CAAC;EACjCC,QAAQ,eAAEF,MAAM,EAAE,CAACC,QAAQ,CAAC,sBAAsB;CACnD,CACF;AAUD,AAAO,IAAME,4BAA4B,gBAA2CN,MAAM,EAAE,CAACC,KAAK,CAChG;EACEM,IAAI,eAAEJ,MAAM,EAAE,CACXC,QAAQ,CAAC,kBAAkB,CAAC,CAC5BI,IAAI,EAAE;EACTH,QAAQ,eAAEF,MAAM,EAAE,CAACC,QAAQ,CAAC,sBAAsB;CACnD,CACF;AAMD,AAAO,IAAMK,sBAAsB,gBAE9BT,MAAM,EAAE,CAACC,KAAK,CAAC;EAClBvB,YAAY,eAAEyB,MAAM,EAAE,CACnBD,KAAK,CAAC,qCAAqC,CAAC,CAC5CE,QAAQ,CAAC,oBAAoB;CACjC,CAAC;AAMF,AAAO,IAAMM,kBAAkB,gBAE1BV,MAAM,EAAE,CAACC,KAAK,CAAC;EAClBrB,GAAG,eAAEuB,MAAM,EAAE,CACVQ,IAAI,CACH,iBAAiB,EACjB,UAACC,cAAsB,EAAEF,kBAAuB;IAC9C,OAAOA,kBAAkB,CAACG,MAAM,CAC9BD,cAAc,EACd,yBAAyB,CAC1B;GACF,CACF,CACAR,QAAQ,CAAC,uBAAuB;CACpC,CAAC;;AC1BF,IAAMU,mBAAmB,GAAiC,SAApDA,mBAAmB,CAAkCC,KAAK;;EAC9D,IACEC,WAAW,GAKTD,KAAK,CALPC,WAAW;IACXC,UAAU,GAIRF,KAAK,CAJPE,UAAU;IACVC,OAAO,GAGLH,KAAK,CAHPG,OAAO;IACPC,QAAQ,GAENJ,KAAK,CAFPI,QAAQ;IAAA,mBAENJ,KAAK,CADPK,SAAS;IAATA,SAAS,iCAAG,UAAU;EAGxB,sBAAwC7E,cAAK,CAAC8E,QAAQ,CAAC,KAAK,CAAC;IAAtDC,YAAY;IAAEC,eAAe;EACpC,uBAAgChF,cAAK,CAAC8E,QAAQ,CAAC,KAAK,CAAC;IAA9CG,QAAQ;IAAEC,WAAW;EAC5B,eAA8CC,OAAO,CAEnD;MACAC,QAAQ,EAAEC,WAAW,CACnBV,OAAO,KAAK,eAAe,GACvBZ,4BAA4B,GAC5BP,6BAA6B,CAClC;MACD8B,gBAAgB,EAAE;KACnB,CAAC;IATMC,QAAQ,YAARA,QAAQ;IAAEC,YAAY,YAAZA,YAAY;IAAEC,SAAS,YAATA,SAAS;EAWzC,IAAMC,YAAY;IAAA,sEAAG,iBACnBC,MACqC;MAAA;QAAA;UAAA;YAAA;cAErC,IAAIf,QAAQ,EAAE;gBACZA,QAAQ,CAACe,MAAM,CAAC;;YACjB;YAAA;cAAA;;;;KACF;IAAA,gBAPKD,YAAY;MAAA;;KAOjB;EAED,OACE1F,6BAAC4F,GAAG;IAACC,EAAE,EAAE,MAAM;IAAEC,IAAI,EAAE,GAAG;IAAElB,QAAQ,EAAEY,YAAY,CAACE,YAAY;KAC7D1F,6BAAC+F,MAAM;IAACC,CAAC,EAAE,CAAC;IAAEC,CAAC,EAAE;KACdhB,QAAQ,IAAIR,WAAW,GACtBA,WAAW,GACT,CAACQ,QAAQ,IAAIP,UAAU,GACzBA,UAAU,GACR,CAACO,QAAQ,IAAI,CAACP,UAAU,GAC1B1E,6BAACkG,IAAI;IAACC,IAAI,EAAC,UAAU;IAACC,EAAE,EAAE;aAEnB,GAEPnB,QAAQ,IACR,CAACR,WAAW,IACVzE,6BAACkG,IAAI;IAACC,IAAI,EAAC,UAAU;IAACC,EAAE,EAAE;eAI7B,CACM,EAETpG,6BAACqG,KAAK;IAACC,OAAO,EAAE;KACb3B,OAAO,KAAK,eAAe,GAC1B3E,6BAACuG,UAAU,oBACLhB,QAAQ,CAAC,MAAM,CAAC;IACpBiB,EAAE,EAAE,MAAM;IACVC,KAAK,EAAE,CAAA5B,SAAS,oBAATA,SAAS,CAAE6B,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,EAAE,KAAG9B,SAAS,oBAATA,SAAS,CAAE+B,KAAK,CAAC,CAAC,CAAC;IAC/DC,WAAW,mBAAgBhC,SAAS,oBAATA,SAAS,CAAEiC,WAAW,EAAE,CAAE;IACrDC,QAAQ,2BAAEtB,SAAS,CAACuB,MAAM,CAAChD,IAAI,qBAArB,sBAAuBhC,OAAO;IACxCiF,QAAQ,EAAExB,SAAS,CAACyB,YAAY;IAChCC,SAAS,EAAE;MACTC,KAAK,EAAE;QACL,YAAY,EAAE,YAAY;QAC1BC,IAAI,EAAE;;;KAGV,GAEFrH,6BAACuG,UAAU,oBACLhB,QAAQ,CAAC,OAAO,CAAC;IACrBiB,EAAE,EAAE,OAAO;IACXC,KAAK,EAAC,OAAO;IACbI,WAAW,EAAC,kBAAkB;IAC9BE,QAAQ,2BAAEtB,SAAS,CAACuB,MAAM,CAACrD,KAAK,qBAAtB,sBAAwB3B,OAAO;IACzCiF,QAAQ,EAAExB,SAAS,CAACyB,YAAY;IAChCC,SAAS,EAAE;MACTC,KAAK,EAAE;QAAE,YAAY,EAAE,aAAa;QAAEC,IAAI,EAAE;;;KAGjD,EAEDrH,6BAACuG,UAAU,oBACLhB,QAAQ,CAAC,UAAU,CAAC;IACxBiB,EAAE,EAAC,UAAU;IACbC,KAAK,EAAC,UAAU;IAChBa,IAAI,EAAEvC,YAAY,GAAG,MAAM,GAAG,UAAU;IACxC8B,WAAW,EAAC,qBAAqB;IACjCE,QAAQ,2BAAEtB,SAAS,CAACuB,MAAM,CAAClD,QAAQ,qBAAzB,sBAA2B9B,OAAO;IAC5CiF,QAAQ,EAAExB,SAAS,CAACyB,YAAY;IAChCK,SAAS,EACPvH,6BAACwH,MAAM;qBACQ,eAAe;MAC5BC,UAAU,EAAE,MAAM;MAClBC,MAAM,EAAE;QAAED,UAAU,EAAE;OAAQ;MAC9BE,OAAO,EAAE;QAAEF,UAAU,EAAE;OAAQ;oBACnB1C,YAAY,GAAG,eAAe,GAAG,eAAe;MAC5D6C,OAAO,EAAE;QAAA,OAAM5C,eAAe,CAAC,UAAC6C,IAAI;UAAA,OAAK,CAACA,IAAI;UAAC;;OAE9C9C,YAAY,GAAG/E,6BAAC8H,QAAQ,OAAG,GAAG9H,6BAAC+H,WAAW,OAAG,CACvC;IAEXZ,SAAS,EAAE;MACTC,KAAK,EAAE;QACL,YAAY,EAAE,gBAAgB;QAC9BC,IAAI,EAAE;;;KAGV,CACI,EACRrH,6BAACwH,MAAM;IACLQ,CAAC,EAAC,MAAM;IACRrD,OAAO,EAAC,SAAS;IACjBsD,SAAS,EAAExC,SAAS,CAACyB,YAAY;IACjCI,IAAI,EAAC,QAAQ;IACblB,EAAE,EAAE;KAEHnB,QAAQ,GAAG,SAAS,GAAG,OAAO,CACxB,EACTjF,6BAAC+F,MAAM,QACL/F,6BAACkG,IAAI,QACFjB,QAAQ,GAAG,0BAA0B,GAAG,iBAAiB,EAAE,GAAG,EAC/DjF,6BAACkG,IAAI;IACHL,EAAE,EAAE,GAAG;mBACM,kBAAkB;IAC/B6B,MAAM,EAAE;MAAEQ,cAAc,EAAE,WAAW;MAAEC,MAAM,EAAE;KAAW;kBAC9ClD,QAAQ,GAAG,kBAAkB,GAAG,mBAAmB;IAC/D2C,OAAO,EAAE;MAAA,OAAM1C,WAAW,CAAC,UAAC2C,IAAI;QAAA,OAAK,CAACA,IAAI;QAAC;;IAC3CO,UAAU,EAAE,MAAM;IAClBf,IAAI,EAAE;KAELpC,QAAQ,GAAG,OAAO,GAAG,SAAS,CAC1B,CACF,CACA,CACL;AAEV,CAAC;;AC/JD,IAAMoD,OAAO,GAAG,SAAVA,OAAO,CAAI7D,KAAmB;;EAClC,IACE8D,QAAQ,GAMN9D,KAAK,CANP8D,QAAQ;IACRC,KAAK,GAKH/D,KAAK,CALP+D,KAAK;IAAA,iBAKH/D,KAAK,CAJPgE,OAAO;IAAPA,OAAO,+BAAG,QAAQ;IAAA,wBAIhBhE,KAAK,CAHPH,cAAc;IAAdA,cAAc,sCAAG,CAAC;IAClBoE,UAAU,GAERjE,KAAK,CAFPiE,UAAU;IACVC,gBAAgB,GACdlE,KAAK,CADPkE,gBAAgB;EAElB,IAAMC,SAAS,GAAG3I,cAAK,CAAC4I,MAAM,CAAoB,IAAI,CAAC;EACvD,eAIIzD,OAAO,CAA2B;MACpCC,QAAQ,EAAEC,WAAW,CAAClB,kBAAkB,CAAC;MACzC0E,OAAO,EAAE;QAAExE,cAAc,EAAEA;OAAgB;MAC3CiB,gBAAgB,EAAE,IAAI;MACtBwD,aAAa,EAAE;QACbzG,GAAG,EAAE;;KAER,CAAC;IAVU0G,WAAW,YAArBxD,QAAQ;IACMyD,eAAe,YAA7BxD,YAAY;IACDyD,YAAY,YAAvBxD,SAAS;EASX,IAAMyD,WAAW;IAAA,sEAAG,iBAAO5I,KAA+B;MAAA;QAAA;UAAA;YAAA;cACxD,IAAIoI,gBAAgB,EAAE;gBACpBA,gBAAgB,CAACpI,KAAK,CAAC;;YACxB;YAAA;cAAA;;;;KACF;IAAA,gBAJK4I,WAAW;MAAA;;KAIhB;EACD,OACElJ,6BAAC4F,GAAG;IACFC,EAAE,EAAC,MAAM;IACTmC,CAAC,EAAE,GAAG;mBACM,kBAAkB;IAC9BpD,QAAQ,EAAEoE,eAAe,CAACE,WAAW;KAErClJ,6BAAC4F,GAAG;IAACuD,EAAE,EAAC;KACLZ,KAAK,GACJA,KAAK,GAELvI,6BAACoJ,OAAO;IAACvD,EAAE,EAAC,IAAI;IAACsD,EAAE,EAAE;wBAGtB,EAEAb,QAAQ,GACPA,QAAQ,GAERtI,6BAACkG,IAAI,qDACN,CACG,EAENlG,6BAACqJ,aAAa;IACZ7C,EAAE,EAAC;KACCuC,WAAW,CAAC,KAAK,CAAC;IACtBhC,QAAQ,2BAAEkC,YAAY,CAACjC,MAAM,CAAC3E,GAAG,qBAAvB,sBAAyBL,OAAO;IAC1CiF,QAAQ,EAAEgC,YAAY,CAAC/B,YAAY;IACnC7C,cAAc,EAAEA,cAAc;IAC9BiF,SAAS;IACTC,UAAU,wBAAEZ,SAAS,CAACa,OAAO,qBAAjB,mBAAmBC,KAAK;IACpCnC,IAAI,EAAEkB;KACN,EACFxI,6BAACwH,MAAM;IACL7C,OAAO,EAAE,SAAS;IAClB+E,GAAG,EAAEf,SAAS;IACdrB,IAAI,EAAC,QAAQ;IACbW,SAAS,EAAEgB,YAAY,CAAC/B,YAAY;IACpCyC,KAAK,EAAE,MAAM;mBACD,mBAAmB;IAC/BC,SAAS,EAAE;KAEVnB,UAAU,GAAGA,UAAU,GAAG,SAAS,CAC7B,CACL;AAEV,CAAC;;ACpED,IAAMoB,mBAAmB,GAAG,SAAtBA,mBAAmB,CAAIrF,KAA2B;;EACtD,IACEsF,WAAW,GAMTtF,KAAK,CANPsF,WAAW;IACXC,kBAAkB,GAKhBvF,KAAK,CALPuF,kBAAkB;IAClB1F,cAAc,GAIZG,KAAK,CAJPH,cAAc;IACdkE,KAAK,GAGH/D,KAAK,CAHP+D,KAAK;IACLD,QAAQ,GAEN9D,KAAK,CAFP8D,QAAQ;IACRI,gBAAgB,GACdlE,KAAK,CADPkE,gBAAgB;EAGlB,eACEvD,OAAO,CAA+B;MACpCC,QAAQ,EAAEC,WAAW,CAACnB,sBAAsB,CAAC;MAC7C4E,aAAa,EAAE;QACb3G,YAAY,EAAE;OACf;MACDmD,gBAAgB,EAAE;KACnB,CAAC;IAPIC,QAAQ,YAARA,QAAQ;IAAEC,YAAY,YAAZA,YAAY;IAAEC,SAAS,YAATA,SAAS;EASzC,IAAMuE,aAAa;IAAA,sEAAG,iBAAO1J,KAAmC;MAAA;QAAA;UAAA;YAAA;cAC9D,IAAIyJ,kBAAkB,EAAE;gBACtBA,kBAAkB,CAACzJ,KAAK,CAAC;;YAC1B;YAAA;cAAA;;;;KACF;IAAA,gBAJK0J,aAAa;MAAA;;KAIlB;EACD,IAAMd,WAAW;IAAA,uEAAG,kBAAO5I,KAA+B;MAAA;QAAA;UAAA;YAAA;cACxD,IAAIoI,gBAAgB,EAAE;gBACpBA,gBAAgB,CAACpI,KAAK,CAAC;;YACxB;YAAA;cAAA;;;;KACF;IAAA,gBAJK4I,WAAW;MAAA;;KAIhB;EAED,IAAQlC,MAAM,GAAmBvB,SAAS,CAAlCuB,MAAM;IAAEE,YAAY,GAAKzB,SAAS,CAA1ByB,YAAY;EAE5B,OACElH,6BAAC4F,GAAG,QACD,CAACkE,WAAW,GACX9J,6BAAC4F,GAAG;IACFC,EAAE,EAAE,MAAM;mBACE,oBAAoB;IAChCmC,CAAC,EAAE,GAAG;IACNpD,QAAQ,EAAEY,YAAY,CAACwE,aAAa;KAEpChK,6BAACuG,UAAU;IACTC,EAAE,EAAC;KACCjB,QAAQ,CAAC,cAAc,CAAC;IAC5BwB,QAAQ,0BAAEC,MAAM,CAAC7E,YAAY,qBAAnB,qBAAqBH,OAAO;IACtCiF,QAAQ,EAAEC,YAAY;IACtBL,WAAW,EAAE,0BAA0B;IACvCM,SAAS,EAAE;MACTC,KAAK,EAAE;QACL,YAAY,EAAE,aAAa;QAC3BC,IAAI,EAAE;;;KAGV,EAEFrH,6BAACwH,MAAM;IACL7C,OAAO,EAAE,SAAS;IAClB2C,IAAI,EAAC,QAAQ;IACbW,SAAS,EAAEf,YAAY;IACvByC,KAAK,EAAE,MAAM;IACbC,SAAS,EAAE,MAAM;mBACL;eAGL,CACL,GAEN5J,6BAAC4F,GAAG;mBAAa;KACf5F,6BAACqI,OAAO;IACNE,KAAK,EAAEA,KAAK;IACZD,QAAQ,EAAEA,QAAQ;IAClBI,gBAAgB,EAAE,0BAACpI,KAAK;MAAA,OAAK4I,WAAW,CAAC5I,KAAK,CAAC;;IAC/C+D,cAAc,EAAEA;IAChB,CAEL,CACG;AAEV,CAAC;;;;"}